
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Week 4: 고급 프롬프트 기법과 최적화 &#8212; Deep Learning for NLP 2025</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-examples.css?v=e236af4b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/language_selector.css?v=6a8ebae4" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script src="../_static/js/hoverxref.js"></script>
    <script src="../_static/js/tooltipster.bundle.min.js"></script>
    <script src="../_static/js/micromodal.min.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-BQJE5V9RK2"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-BQJE5V9RK2');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-BQJE5V9RK2');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"N": "\\mathbb{N}", "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'week04/index';</script>
    <script src="../_static/language_switcher.js?v=730be77c"></script>
    <script src="../_static/chat.js?v=f0de43d7"></script>
    <link rel="icon" href="https://assets.entelecheia.ai/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Week 5: LLM 평가 패러다임과 벤치마크" href="../week05/index.html" />
    <link rel="prev" title="Week 3: 현대적 PEFT 기법을 활용한 효율적 파인튜닝" href="../week03/index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <script src="/_static/language_switcher.js"></script>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
<div class="sidebar-lang-select">  <nav class="menu">    <ul class="clearfix">      <li class="current-item">        <a href="#" class="clicker">          한국어 <span class="arrow">&#9660;</span>        </a>        <ul class="sub-menu">                    <li><a href="#" onclick="switchLanguage('en'); return false;">English</a></li>          <li><a href="#" onclick="switchLanguage('ko'); return false;">한국어</a></li>        </ul>      </li>    </ul>  </nav></div>
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Deep Learning for NLP 2025</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    딥러닝자연어처리 (131307379A)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture Notes</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../week01/index.html">Week 1: Transformer 및 차세대 아키텍처</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../week01/qna.html">Transformer, Mamba, RWKV, Jamba 아키텍처 Q&amp;A</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../week02/index.html">Week 2: PyTorch 2.x와 최신 딥러닝 프레임워크</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week03/index.html">Week 3: 현대적 PEFT 기법을 활용한 효율적 파인튜닝</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Week 4: 고급 프롬프트 기법과 최적화</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week05/index.html">Week 5: LLM 평가 패러다임과 벤치마크</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week06/index.html">Week 6: 멀티모달 NLP의 발전</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week07/index.html">Week 7: 초장문맥 처리와 효율적 추론</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week08/index.html">Week 8: 핵심 복습 및 최신 동향</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week09/index.html">Week 9: 고급 RAG 아키텍처</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week10/index.html">Week 10: 정렬 기법의 발전</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week11/index.html">Week 11: 프로덕션 에이전트 시스템</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week12/index.html">Week 12: AI 규제와 책임 있는 AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week13/index.html">Week 13: 온톨로지와 AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week14/index.html">Week 14: 2025년 NLP 현황</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Workshops</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../workshops/index.html">LLM From Scratch 워크숍</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workshops/week01.html">1주차 워크숍: LLM 개요 및 개발 환경 구축</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Projects</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../projects/index.html">프로젝트 운영 가이드라인</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus/index.html">강의계획서</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">Who made this book?</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/entelecheia/deepnlp-2025" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/entelecheia/deepnlp-2025/edit/main/book/ko/week04/index.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/entelecheia/deepnlp-2025/issues/new?title=Issue%20on%20page%20%2Fweek04/index.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/week04/index.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Week 4: 고급 프롬프트 기법과 최적화</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1. 체계적 프롬프트 기법: 역할 부여와 구조화된 프롬프팅</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#role-prompting">1.1 역할 부여(Role Prompting)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#structured-prompting">1.2 구조화된 프롬프팅(Structured Prompting)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">1.3 실습 예제: 체계적 프롬프트 구성</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#self-consistency-gsm8k">2. Self-Consistency 기법과 GSM8K 성능 향상</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gsm8k">2.1 GSM8K 성능 향상 사례</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#self-consistency">2.2 Self-Consistency 구현 예제</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.3 Self-Consistency의 장점과 한계</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tree-of-thoughts">3. Tree of Thoughts 기법: 복잡한 문제 해결을 위한 탐색</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#game-of-24">3.1 Game of 24 성능 향상 사례</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">3.2 Tree of Thoughts 구현 예제</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">3.3 Tree of Thoughts의 장점과 한계</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dspy">4. DSPy 프레임워크: 선언형 프롬프트 프로그래밍</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">4.1 DSPy의 핵심 구성 요소</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#signature">Signature(시그니처)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#module">Module(모듈)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizer">Optimizer(최적화기)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">4.2 DSPy 실습 예제</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">4.3 DSPy의 장점과 한계</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ape">5. 자동 프롬프트 최적화(APE)와 최신 동향</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automatic-prompt-engineer-ape">5.1 Automatic Prompt Engineer (APE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opro-optimization-by-prompting">5.2 OPRO (Optimization by PROmpting)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">5.3 성능 향상 사례</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">5.4 자동 프롬프트 최적화의 의의</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">6. 실습 예시: DSPy를 활용한 프롬프트 자동 최적화 파이프라인</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">6.1 문제 정의</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#signature-module">6.2 Signature &amp; Module 구성</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">6.3 DSPy 최적화 과정</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">체크포인트 질문</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">참고자료</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">주요 논문 및 연구 자료</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">기술 문서 및 구현체</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">온라인 리소스 및 블로그</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">벤치마크 및 평가 자료</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="week-4">
<h1>Week 4: 고급 프롬프트 기법과 최적화<a class="headerlink" href="#week-4" title="Link to this heading">#</a></h1>
<section id="id1">
<h2>1. 체계적 프롬프트 기법: 역할 부여와 구조화된 프롬프팅<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>대규모 언어모델(LLM)의 성능을 끌어올리기 위해 <strong>프롬프트 엔지니어링</strong> 기법들이 발전해왔다. 그 중 **역할 부여(role prompting)**와 **구조화된 프롬프팅(structured prompting)**은 모델의 응답 품질을 높이기 위한 체계적인 방법들이다.</p>
<section id="role-prompting">
<h3>1.1 역할 부여(Role Prompting)<a class="headerlink" href="#role-prompting" title="Link to this heading">#</a></h3>
<p><strong>역할 부여</strong>는 모델에게 특정 <strong>페르소나</strong>나 역할을 부여하여 답변 스타일과 초점을 조정하는 기법이다. 예를 들어 프롬프트를 “당신은 역사 선생님입니다. 산업혁명의 중요성을 설명하세요.”와 같이 시작하면, 모델은 역사 교사의 어투와 관점을 모방하여 보다 맥락에 맞는 설명을 제공한다. 역할 부여를 통해 응답의 톤과 형식을 제어할 수 있을 뿐 아니라, 모델의 <strong>추론 성능</strong>도 향상될 수 있음이 보고되었다. 실제로 “당신은 수학자입니다…”와 같이 전문가 역할을 지정하면 복잡한 문제에서 모델이 <strong>보다 일관되고 정확한 추론</strong>을 하는 데 도움이 될 수 있다.</p>
</section>
<section id="structured-prompting">
<h3>1.2 구조화된 프롬프팅(Structured Prompting)<a class="headerlink" href="#structured-prompting" title="Link to this heading">#</a></h3>
<p><strong>구조화된 프롬프팅</strong>은 프롬프트를 명확한 <strong>구조와 단계</strong>에 따라 작성하여 모델이 체계적으로 답하도록 유도하는 기법이다. 단순 대화형 프롬프트와 달리, 구조화된 프롬프트는 역할, 과제, 형식 등을 명시적으로 구분한다. 예를 들어 <strong>“역할(Role) - 과제(Task) - 형식(Format)”</strong> 프레임워크를 사용하면:</p>
<ul class="simple">
<li><p><strong>Role</strong>: “역사 선생님으로서,”</p></li>
<li><p><strong>Task</strong>: “1차 세계대전의 원인을 설명하고,”</p></li>
<li><p><strong>Format</strong>: “학생이 이해하기 쉽게 bullet point로 답하세요.”</p></li>
</ul>
<p>이러한 <strong>RTF 프레임워크</strong> 외에도, <strong>CIO (Context-Input-Output)</strong>, <strong>WWHW (Who-What-How-Why)</strong> 등 여러 구조화 전략이 제안되어 왔다. 구조화된 프롬프트는 모델에게 <strong>명확한 지침과 출력 형식</strong>을 제공하므로, 응답의 <strong>일관성</strong>과 <strong>정확성</strong>을 높이는 데 효과적이다. 또한 JSON과 같은 포맷을 요구하는 <strong>정형 출력</strong>이 필요한 경우, 필드별로 프롬프트를 제시하여 신뢰성 있는 결과를 얻을 수 있다.</p>
</section>
<section id="id2">
<h3>1.3 실습 예제: 체계적 프롬프트 구성<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">create_structured_prompt</span><span class="p">(</span><span class="n">role</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">format_instruction</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    구조화된 프롬프트를 생성하는 함수</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        role: 모델에게 부여할 역할</span>
<span class="sd">        task: 수행할 과제</span>
<span class="sd">        format_instruction: 출력 형식 지시</span>
<span class="sd">        context: 추가 컨텍스트 (선택사항)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;역할(Role): </span><span class="si">{</span><span class="n">role</span><span class="si">}</span>

<span class="s2">과제(Task): </span><span class="si">{</span><span class="n">task</span><span class="si">}</span>

<span class="s2">형식(Format): </span><span class="si">{</span><span class="n">format_instruction</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">context</span><span class="p">:</span>
        <span class="n">prompt</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">컨텍스트: </span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&quot;</span>
    
    <span class="k">return</span> <span class="n">prompt</span>

<span class="c1"># 예시 사용</span>
<span class="n">role</span> <span class="o">=</span> <span class="s2">&quot;숙련된 소프트웨어 개발자&quot;</span>
<span class="n">task</span> <span class="o">=</span> <span class="s2">&quot;새로운 웹 서버를 설정하는 방법을 단계별로 알려주세요&quot;</span>
<span class="n">format_instruction</span> <span class="o">=</span> <span class="s2">&quot;각 단계를 번호로 나열하고, 중요한 부분은 강조해주세요&quot;</span>

<span class="n">prompt</span> <span class="o">=</span> <span class="n">create_structured_prompt</span><span class="p">(</span><span class="n">role</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">format_instruction</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>출력 예시:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">역할</span><span class="p">(</span><span class="n">Role</span><span class="p">):</span> <span class="n">숙련된</span> <span class="n">소프트웨어</span> <span class="n">개발자</span>

<span class="n">과제</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span> <span class="n">새로운</span> <span class="n">웹</span> <span class="n">서버를</span> <span class="n">설정하는</span> <span class="n">방법을</span> <span class="n">단계별로</span> <span class="n">알려주세요</span>

<span class="n">형식</span><span class="p">(</span><span class="n">Format</span><span class="p">):</span> <span class="n">각</span> <span class="n">단계를</span> <span class="n">번호로</span> <span class="n">나열하고</span><span class="p">,</span> <span class="n">중요한</span> <span class="n">부분은</span> <span class="n">강조해주세요</span>
</pre></div>
</div>
<p>위와 같은 체계적 프롬프트는 모델이 답변할 <strong>역할</strong>과 <strong>목표</strong>, <strong>형식</strong>을 명확히 인지하도록 돕기 때문에, 산발적인 지시보다 높은 품질의 응답을 얻을 수 있다.</p>
</section>
</section>
<section id="self-consistency-gsm8k">
<h2>2. Self-Consistency 기법과 GSM8K 성능 향상<a class="headerlink" href="#self-consistency-gsm8k" title="Link to this heading">#</a></h2>
<p>복잡한 문제에 대한 <strong>체인-오브-생각(Chain-of-Thought, CoT)</strong> 프롬프팅에서는 종종 모델이 한 번의 추론 경로만 따르기 때문에 <strong>초기 경로의 편향</strong>에 성능이 좌우될 수 있다. <strong>Self-Consistency(자가 일관성)</strong> 기법은 이러한 문제를 해결하기 위한 <strong>디코딩 전략</strong>으로, 한 번의 응답 대신 <strong>다양한 추론 경로를 여러 번 샘플링</strong>하고 최종 답을 <strong>투표</strong>로 결정한다. 다시 말해, 모델에게 동일한 질문에 대해 여러 <strong>생각의 흐름</strong>을 (주로 temperature를 주어) 생성하게 한 뒤, <strong>가장 일관되게 등장하는 최종 답변</strong>을 선택하는 방식이다.</p>
<p>이 방법의 직관은 “어려운 문제는 생각하는 경로는 다를 수 있어도 <strong>정답은 하나</strong>”라는 점을 활용하는 것이다. Self-Consistency를 적용하면 모델이 스스로 다양한 접근을 탐색한 후 <strong>교집합에 가까운 답</strong>을 취하게 되어, 단일 경로의 오류를 줄이고 복잡한 문제에서 성능을 크게 높일 수 있다.</p>
<section id="gsm8k">
<h3>2.1 GSM8K 성능 향상 사례<a class="headerlink" href="#gsm8k" title="Link to this heading">#</a></h3>
<p>수학적 추론이 필요한 <strong>GSM8K</strong> 벤치마크에서 Self-Consistency는 매우 두드러진 향상을 보였다. Wang 등(2022)의 연구에 따르면, <strong>CoT 프롬프트에 Self-Consistency 디코딩을 적용</strong>했을 때 GSM8K에서 <strong>기존 대비 17.9%p 성능 향상</strong>을 달성했다. 예컨대, 한 모델의 GSM8K 정확도가 55%였던 것이 Self-Consistency 적용 후 약 72.9%로 상승한 셈이다. 이 기법은 다른 추론 과제들(SVAMP, AQuA, StrategyQA 등)에서도 두 자릿수의 성능 향상을 가져왔으며, ICLR 2023에 발표된 대표 논문에서도 해당 효과를 입증하였다.</p>
</section>
<section id="self-consistency">
<h3>2.2 Self-Consistency 구현 예제<a class="headerlink" href="#self-consistency" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">openai</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="k">def</span><span class="w"> </span><span class="nf">extract_final_answer</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;텍스트에서 최종 답을 추출하는 함수&quot;&quot;&quot;</span>
    <span class="c1"># 다양한 패턴으로 답을 찾기</span>
    <span class="n">patterns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">r</span><span class="s1">&#39;답은\s*(\d+)&#39;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s1">&#39;정답은\s*(\d+)&#39;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s1">&#39;따라서\s*(\d+)&#39;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s1">&#39;결과는\s*(\d+)&#39;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s1">&#39;(\d+)\s*입니다&#39;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s1">&#39;(\d+)\s*이다&#39;</span>
    <span class="p">]</span>
    
    <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">patterns</span><span class="p">:</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="c1"># 마지막 숫자를 찾기</span>
    <span class="n">numbers</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">numbers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">numbers</span> <span class="k">else</span> <span class="kc">None</span>

<span class="k">def</span><span class="w"> </span><span class="nf">self_consistency_sampling</span><span class="p">(</span><span class="n">question</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Self-Consistency를 통한 다중 샘플링 및 투표</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        question: 수학 문제</span>
<span class="sd">        model: 사용할 모델</span>
<span class="sd">        num_samples: 생성할 샘플 수</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cot_prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;다음 수학 문제를 단계별로 풀어보세요.</span>

<span class="s2">문제: </span><span class="si">{</span><span class="n">question</span><span class="si">}</span>

<span class="s2">단계별로 생각해보고, 마지막에 최종 답을 제시하세요.&quot;&quot;&quot;</span>

    <span class="n">answers</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">openai</span><span class="o">.</span><span class="n">ChatCompletion</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
                <span class="n">messages</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">cot_prompt</span><span class="p">}],</span>
                <span class="n">temperature</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>  <span class="c1"># 다양성을 위해 높은 temperature 사용</span>
                <span class="n">max_tokens</span><span class="o">=</span><span class="mi">500</span>
            <span class="p">)</span>
            
            <span class="n">answer_text</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span>
            <span class="n">final_answer</span> <span class="o">=</span> <span class="n">extract_final_answer</span><span class="p">(</span><span class="n">answer_text</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">final_answer</span><span class="p">:</span>
                <span class="n">answers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final_answer</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;샘플 </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">final_answer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;샘플 </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> 생성 중 오류: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1"># 투표를 통한 최종 답 결정</span>
    <span class="k">if</span> <span class="n">answers</span><span class="p">:</span>
        <span class="n">answer_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">answers</span><span class="p">)</span>
        <span class="n">most_common</span> <span class="o">=</span> <span class="n">answer_counts</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">final_answer</span> <span class="o">=</span> <span class="n">most_common</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">confidence</span> <span class="o">=</span> <span class="n">most_common</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">answers</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">최종 답: </span><span class="si">{</span><span class="n">final_answer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;신뢰도: </span><span class="si">{</span><span class="n">confidence</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">most_common</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">answers</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">final_answer</span><span class="p">,</span> <span class="n">confidence</span>
    
    <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span>

<span class="c1"># 사용 예시</span>
<span class="n">question</span> <span class="o">=</span> <span class="s2">&quot;사과 3개와 배 2개를 샀는데, 사과는 개당 500원, 배는 개당 700원입니다. 총 얼마를 지불해야 하나요?&quot;</span>

<span class="n">final_answer</span><span class="p">,</span> <span class="n">confidence</span> <span class="o">=</span> <span class="n">self_consistency_sampling</span><span class="p">(</span><span class="n">question</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>출력 예시:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">샘플</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2900</span>
<span class="n">샘플</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2900</span>
<span class="n">샘플</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2900</span>
<span class="n">샘플</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2900</span>
<span class="n">샘플</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">2900</span>

<span class="n">최종</span> <span class="n">답</span><span class="p">:</span> <span class="mi">2900</span>
<span class="n">신뢰도</span><span class="p">:</span> <span class="mf">1.00</span> <span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3>2.3 Self-Consistency의 장점과 한계<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p><strong>장점:</strong></p>
<ul class="simple">
<li><p><strong>불확실성 감소</strong>: 여러 경로를 탐색하여 단일 경로의 오류를 줄인다</p></li>
<li><p><strong>안정적인 성능</strong>: 수학 문제나 상식 추론 문제에서 더 안정적인 정답률을 제공한다</p></li>
<li><p><strong>구현 간단</strong>: 기존 CoT 프롬프트에 temperature 조정과 투표 로직만 추가하면 된다</p></li>
</ul>
<p><strong>한계:</strong></p>
<ul class="simple">
<li><p><strong>계산 비용 증가</strong>: 여러 번의 추론이 필요하므로 비용이 증가한다</p></li>
<li><p><strong>시간 지연</strong>: 실시간 응답이 필요한 경우 부적합할 수 있다</p></li>
<li><p><strong>일관성 보장 불가</strong>: 모든 샘플이 같은 오답을 낼 가능성도 있다</p></li>
</ul>
</section>
</section>
<section id="tree-of-thoughts">
<h2>3. Tree of Thoughts 기법: 복잡한 문제 해결을 위한 탐색<a class="headerlink" href="#tree-of-thoughts" title="Link to this heading">#</a></h2>
<p>**Tree of Thoughts (ToT)**는 Chain-of-Thought를 확장하여, 모델이 <strong>여러 갈래의 사고를 나무(tree) 구조로 탐색</strong>하도록 한 프레임워크다. Yao 등(2023)이 제안한 ToT의 핵심 개념은, 모델에게 문제 해결 중간단계(생각)를 하나씩 생성하게 하되 <strong>여러 대안 분기</strong>를 만들어 탐색하고, 각 단계마다 <strong>자체 평가</strong>를 통해 유망한 가지를 선택하거나 불필요한 가지는 가지치기(backtracking)하는 것이다. 이로써 LLM은 <strong>미리 내다보는 전략적 사고</strong>(lookahead)를 흉내내며, 복잡한 문제에서도 보다 체계적으로 탐색할 수 있게 된다.</p>
<p>ToT 알고리즘은 일반적으로 BFS/DFS 등의 <strong>검색 기법</strong>과 결합된다. 예를 들어, 어떤 문제를 풀 때 3단계의 중간 사고가 필요하다면, 1단계에서 여러 후보 생각을 만들고, <strong>각각에 대해 2단계 후보</strong>들을 전개한 뒤, 최종적으로 3단계까지 진행하면서 <strong>“해결 가능성”을 모델이 평가</strong>하여 가지를 선택한다. 모델은 각 중간 생각에 대해 <em>“이 경로가 해결로 이어질 것 같다(가능)”</em> / <em>“불가능할 것 같다”</em> 등을 표시하여, <strong>가능성 높은 경로만 남기는</strong> 방식으로 탐색 효율을 높인다.</p>
<section id="game-of-24">
<h3>3.1 Game of 24 성능 향상 사례<a class="headerlink" href="#game-of-24" title="Link to this heading">#</a></h3>
<p>ToT의 위력은 수학 퍼즐 <em>24 게임</em>에서 극명하게 드러났다. <em>24 게임</em>은 주어진 4개의 숫자를 모두 사용하여 24를 만드는 수식을 찾는 문제인데, GPT-4를 <strong>기존 CoT 프롬프트</strong>로만 풀게 하면 **성공률 4%**에 불과했다. 반면 동일한 GPT-4에게 <strong>Tree of Thoughts 전략</strong>을 적용하자, **성공률이 무려 74%**까지 상승했다. 이는 ToT가 여러 경로의 탐색을 통해 정답에 도달하는 비율을 극적으로 높였음을 보여준다. 연구 결과에 따르면, ToT는 창의적 글쓰기, 미니 크로스워드 등 <strong>탐색과 계획이 필요한 과제 전반</strong>에서 기존 CoT보다 월등한 성능을 보였다.</p>
</section>
<section id="id4">
<h3>3.2 Tree of Thoughts 구현 예제<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">openai</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TreeOfThoughts</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thoughts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluations</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_thoughts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">current_thoughts</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;현재 상황에서 가능한 다음 생각들을 생성&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">current_thoughts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">current_thoughts</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="n">context</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;문제: </span><span class="si">{</span><span class="n">problem</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">current_thoughts</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;현재까지의 생각: </span><span class="si">{</span><span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_thoughts</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        
        <span class="n">prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span>

<span class="s2">위 문제를 해결하기 위한 다음 단계의 가능한 접근 방법들을 3-5개 제시해주세요.</span>
<span class="s2">각 접근 방법은 구체적이고 실행 가능해야 합니다.</span>

<span class="s2">형식:</span>
<span class="s2">1. [접근 방법 1]</span>
<span class="s2">2. [접근 방법 2]</span>
<span class="s2">3. [접근 방법 3]</span>
<span class="s2">...&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">openai</span><span class="o">.</span><span class="n">ChatCompletion</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
                <span class="n">messages</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">}],</span>
                <span class="n">temperature</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                <span class="n">max_tokens</span><span class="o">=</span><span class="mi">300</span>
            <span class="p">)</span>
            
            <span class="n">thoughts_text</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span>
            <span class="n">thoughts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_thoughts</span><span class="p">(</span><span class="n">thoughts_text</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">thoughts</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;생각 생성 중 오류: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_thought</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">thought_path</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;생각 경로의 유망성을 평가 (0-1 점수)&quot;&quot;&quot;</span>
        
        <span class="n">context</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;문제: </span><span class="si">{</span><span class="n">problem</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">context</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;생각 경로: </span><span class="si">{</span><span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">thought_path</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        
        <span class="n">prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span>

<span class="s2">위 생각 경로가 문제 해결에 얼마나 유망한지 0-10점으로 평가해주세요.</span>
<span class="s2">평가 기준:</span>
<span class="s2">- 논리적 일관성</span>
<span class="s2">- 문제 해결 가능성</span>
<span class="s2">- 실행 가능성</span>

<span class="s2">점수만 숫자로 답해주세요 (예: 7)&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">openai</span><span class="o">.</span><span class="n">ChatCompletion</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
                <span class="n">messages</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">}],</span>
                <span class="n">temperature</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                <span class="n">max_tokens</span><span class="o">=</span><span class="mi">10</span>
            <span class="p">)</span>
            
            <span class="n">score_text</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">score</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">score_text</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10.0</span>  <span class="c1"># 0-1 범위로 정규화</span>
            <span class="k">return</span> <span class="n">score</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;평가 중 오류: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mf">0.0</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">solve_with_tot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">beam_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tree of Thoughts로 문제 해결&quot;&quot;&quot;</span>
        
        <span class="c1"># 초기 상태</span>
        <span class="n">current_paths</span> <span class="o">=</span> <span class="p">[[]]</span>  <span class="c1"># 빈 경로로 시작</span>
        <span class="n">best_solution</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">best_score</span> <span class="o">=</span> <span class="mf">0.0</span>
        
        <span class="k">for</span> <span class="n">depth</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_depth</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== 깊이 </span><span class="si">{</span><span class="n">depth</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> ===&quot;</span><span class="p">)</span>
            <span class="n">new_paths</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">current_paths</span><span class="p">:</span>
                <span class="c1"># 현재 경로에서 다음 생각들 생성</span>
                <span class="n">next_thoughts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_thoughts</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;경로 </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">next_thoughts</span><span class="p">)</span><span class="si">}</span><span class="s2">개 후보 생성&quot;</span><span class="p">)</span>
                
                <span class="k">for</span> <span class="n">thought</span> <span class="ow">in</span> <span class="n">next_thoughts</span><span class="p">:</span>
                    <span class="n">new_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[</span><span class="n">thought</span><span class="p">]</span>
                    <span class="n">score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_thought</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">new_path</span><span class="p">)</span>
                    
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &#39;</span><span class="si">{</span><span class="n">thought</span><span class="si">}</span><span class="s2">&#39; -&gt; 점수: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="n">new_paths</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">new_path</span><span class="p">,</span> <span class="n">score</span><span class="p">))</span>
                    
                    <span class="c1"># 최고 점수 업데이트</span>
                    <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="n">best_score</span><span class="p">:</span>
                        <span class="n">best_score</span> <span class="o">=</span> <span class="n">score</span>
                        <span class="n">best_solution</span> <span class="o">=</span> <span class="n">new_path</span>
            
            <span class="c1"># 상위 beam_width개 경로만 유지</span>
            <span class="n">new_paths</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">current_paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span> <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">new_paths</span><span class="p">[:</span><span class="n">beam_width</span><span class="p">]]</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;상위 </span><span class="si">{</span><span class="n">beam_width</span><span class="si">}</span><span class="s2">개 경로 유지&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;best_solution&quot;</span><span class="p">:</span> <span class="n">best_solution</span><span class="p">,</span>
            <span class="s2">&quot;best_score&quot;</span><span class="p">:</span> <span class="n">best_score</span><span class="p">,</span>
            <span class="s2">&quot;all_paths&quot;</span><span class="p">:</span> <span class="n">current_paths</span>
        <span class="p">}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_thoughts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;생성된 텍스트에서 생각들을 파싱&quot;&quot;&quot;</span>
        <span class="n">thoughts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">line</span> <span class="ow">and</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)):</span>
                <span class="c1"># 번호나 불릿 포인트 제거</span>
                <span class="n">thought</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">thought</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;- &#39;</span><span class="p">):</span>
                    <span class="n">thought</span> <span class="o">=</span> <span class="n">thought</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">thought</span><span class="p">:</span>
                    <span class="n">thoughts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thought</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">thoughts</span>

<span class="c1"># 사용 예시</span>
<span class="k">def</span><span class="w"> </span><span class="nf">solve_24_game</span><span class="p">(</span><span class="n">numbers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;24 게임 해결&quot;&quot;&quot;</span>
    <span class="n">problem</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;주어진 숫자 </span><span class="si">{</span><span class="n">numbers</span><span class="si">}</span><span class="s2">를 사용하여 24를 만드는 수식을 찾으세요. 각 숫자는 정확히 한 번씩만 사용해야 합니다.&quot;</span>
    
    <span class="n">tot</span> <span class="o">=</span> <span class="n">TreeOfThoughts</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">tot</span><span class="o">.</span><span class="n">solve_with_tot</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">beam_width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== 최종 결과 ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;최고 점수: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;best_score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;최적 경로: </span><span class="si">{</span><span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;best_solution&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">result</span>

<span class="c1"># 예시 실행</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">solve_24_game</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>출력 예시:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">===</span> <span class="n">깊이</span> <span class="mi">1</span> <span class="o">===</span>
<span class="n">경로</span> <span class="p">[]:</span> <span class="mi">4</span><span class="n">개</span> <span class="n">후보</span> <span class="n">생성</span>
  <span class="s1">&#39;먼저 두 숫자를 곱해서 큰 수를 만들어보자&#39;</span> <span class="o">-&gt;</span> <span class="n">점수</span><span class="p">:</span> <span class="mf">0.60</span>
  <span class="s1">&#39;더하기와 빼기를 조합해보자&#39;</span> <span class="o">-&gt;</span> <span class="n">점수</span><span class="p">:</span> <span class="mf">0.50</span>
  <span class="s1">&#39;나누기를 활용해보자&#39;</span> <span class="o">-&gt;</span> <span class="n">점수</span><span class="p">:</span> <span class="mf">0.70</span>
  <span class="s1">&#39;괄호를 사용한 복합 연산을 시도해보자&#39;</span> <span class="o">-&gt;</span> <span class="n">점수</span><span class="p">:</span> <span class="mf">0.80</span>

<span class="n">상위</span> <span class="mi">3</span><span class="n">개</span> <span class="n">경로</span> <span class="n">유지</span>

<span class="o">===</span> <span class="n">최종</span> <span class="n">결과</span> <span class="o">===</span>
<span class="n">최고</span> <span class="n">점수</span><span class="p">:</span> <span class="mf">0.90</span>
<span class="n">최적</span> <span class="n">경로</span><span class="p">:</span> <span class="n">괄호를</span> <span class="n">사용한</span> <span class="n">복합</span> <span class="n">연산을</span> <span class="n">시도해보자</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="mi">8</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">6</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">-&gt;</span> <span class="mi">16</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">=</span> <span class="mi">24</span>
</pre></div>
</div>
</section>
<section id="id5">
<h3>3.3 Tree of Thoughts의 장점과 한계<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p><strong>장점:</strong></p>
<ul class="simple">
<li><p><strong>체계적 탐색</strong>: 여러 가능성을 체계적으로 탐색하여 최적해에 도달할 가능성이 높다</p></li>
<li><p><strong>백트래킹</strong>: 잘못된 경로를 조기에 포기하여 효율성을 높인다</p></li>
<li><p><strong>복잡한 문제 해결</strong>: 단순한 CoT로는 해결하기 어려운 복잡한 문제에 효과적이다</p></li>
</ul>
<p><strong>한계:</strong></p>
<ul class="simple">
<li><p><strong>계산 비용</strong>: 여러 경로를 탐색하므로 비용이 크게 증가한다</p></li>
<li><p><strong>평가 주관성</strong>: 모델이 스스로 평가하므로 일관성이 떨어질 수 있다</p></li>
<li><p><strong>구현 복잡성</strong>: 단순한 CoT보다 구현이 복잡하다</p></li>
</ul>
</section>
</section>
<section id="dspy">
<h2>4. DSPy 프레임워크: 선언형 프롬프트 프로그래밍<a class="headerlink" href="#dspy" title="Link to this heading">#</a></h2>
<p>프롬프트 엔지니어링을 <strong>보다 체계적이고 모듈화</strong>하기 위한 혁신적 접근으로 <strong>DSPy</strong> 프레임워크가 등장했다. DSPy(Declarative <strong>Self-Improving</strong> Python)는 프롬프트를 일종의 <strong>프로그램</strong>으로 취급하여, **선언형(declarative)**으로 작성하고 자동 최적화까지 지원하는 프레임워크다. 이를 통해 일일이 프롬프트 문장을 수정하는 대신, 구조화된 코드로 AI 동작을 기술하고 관리할 수 있다.</p>
<section id="id6">
<h3>4.1 DSPy의 핵심 구성 요소<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>DSPy의 <strong>구조</strong>는 세 가지 핵심 요소로 이루어진다:</p>
<section id="signature">
<h4>Signature(시그니처)<a class="headerlink" href="#signature" title="Link to this heading">#</a></h4>
<p>해결하려는 작업의 <strong>입력과 출력 형식</strong>을 선언한다. 마치 함수의 시그니처를 정의하듯이, 어떤 입력 필드를 받고 어떤 출력 필드를 생성할지 명시한다. 예를 들어 “question -&gt; answer: float”와 같이 문자열로 간단히 표현하거나, Python 클래스 상속을 통해 상세히 정의할 수 있다. 시그니처는 <strong>필드 타입</strong>까지 지정할 수 있어, DSPy는 이를 기반으로 프롬프트 틀을 자동 생성하고 응답을 해당 타입으로 파싱한다.</p>
</section>
<section id="module">
<h4>Module(모듈)<a class="headerlink" href="#module" title="Link to this heading">#</a></h4>
<p>프롬프트를 생성하고 모델을 호출하는 <strong>전략</strong>을 캡슐화한다. Signature를 토대로 어떤 프롬프팅 기법을 쓸지 선택하는 역할을 한다. DSPy는 다양한 모듈을 제공한다:</p>
<ul class="simple">
<li><p><strong>dspy.Predict</strong>: 기본적인 단일 질문-응답 프레임을 생성한다</p></li>
<li><p><strong>dspy.ChainOfThought</strong>: Chain-of-Thought 방식으로 <strong>중간 추론과 최종 답</strong>을 모두 포함하는 프롬프트를 만든다</p></li>
<li><p><strong>dspy.ReAct</strong>: Tool 사용과 반응형 추론(ReAct)을 적용한 에이전트 프롬프트를 구성한다</p></li>
<li><p><strong>BestOfN, Parallel, Refine</strong> 등 복잡한 파이프라인용 모듈들</p></li>
</ul>
<p>사용자는 시그니처에 맞춰 모듈을 선택하면, DSPy가 해당 전략에 맞게 <strong>프롬프트를 조립</strong>해 준다. 예컨대, 수학 문제에 ChainOfThought 모듈을 적용하면, “<strong>[[문제]]</strong>\n{question}\n**[[풀이]]<strong>\n…</strong>[[답]]**…” 같은 구조화된 프롬프트가 자동 생성된다.</p>
</section>
<section id="optimizer">
<h4>Optimizer(최적화기)<a class="headerlink" href="#optimizer" title="Link to this heading">#</a></h4>
<p>DSPy의 비밀 병기로서, 프롬프트(또는 모델 파라미터)를 <strong>자동으로 튜닝</strong>해주는 알고리즘이다. Optimizer는 (i) DSPy 프로그램(모듈들의 조합), (ii) 평가 지표(metric 함수), (iii) 소량의 훈련 입력을 받아 동작한다. Optimizer는 LLM을 활용해 더 나은 지침문이나 예시를 생성하고, 여러 후보 프롬프트를 <strong>탐색 및 평가</strong>하여 성능을 최대화하는 방향으로 프롬프트를 개선한다.</p>
<p>예를 들어 <strong>MIPROv2</strong>라는 최적화기는, 초기에 프로그램을 여러 입력에 실행해본 **추론 기록(trace)**을 수집하고 높은 점수의 경로를 선별한 뒤, 이를 바탕으로 지침문을 변형/제안하고 최종적으로 <strong>조합 탐색</strong>을 통해 최적의 프롬프트를 찾아낸다. 이러한 과정을 통해 Optimizer는 사람이 직접 튜닝하지 않아도 <strong>Few-shot 예제 구성, 지시문 재구성, 파인튜닝</strong>까지 자동화할 수 있다. DSPy에는 MIPROv2 외에도 <strong>Bootstrap</strong> 시리즈, <strong>Ensemble</strong>, <strong>SIMBA</strong> 등 다양한 자동 프롬프트 최적화 알고리즘이 내장되어 있다.</p>
</section>
</section>
<section id="id7">
<h3>4.2 DSPy 실습 예제<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">dspy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Literal</span>

<span class="c1"># 1. 시그니처 정의</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SentimentCls</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Signature</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Classify sentiment of a given sentence.&quot;&quot;&quot;</span>
    <span class="n">sentence</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">InputField</span><span class="p">()</span>
    <span class="n">sentiment</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;positive&quot;</span><span class="p">,</span> <span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;neutral&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">OutputField</span><span class="p">()</span>
    <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">OutputField</span><span class="p">()</span>

<span class="c1"># 2. 모듈 생성</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="n">SentimentCls</span><span class="p">)</span>

<span class="c1"># 3. 사용 예시</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">classifier</span><span class="p">(</span><span class="n">sentence</span><span class="o">=</span><span class="s2">&quot;This book was super fun to read, though not the last chapter.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;감정: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">sentiment</span><span class="si">}</span><span class="s2">, 신뢰도: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">confidence</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>출력 예시:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">감정</span><span class="p">:</span> <span class="n">positive</span><span class="p">,</span> <span class="n">신뢰도</span><span class="p">:</span> <span class="mf">0.85</span>
</pre></div>
</div>
<p>위 코드에서 SentimentCls 시그니처를 정의하고, dspy.Predict 모듈을 사용해 프롬프트를 생성한다. DSPy는 자동으로 <strong>시스템 메시지</strong>에 입력/출력 필드를 설명하고, 사용자 메시지에 실제 입력값을 넣어 프롬프트를 구성한다. 모델의 응답은 DSPy에 의해 result.sentiment, result.confidence와 같이 <strong>구조화된 출력</strong>으로 파싱된다. 이를 통해 프롬프트 작성이 코드 수준에서 <strong>재현 가능</strong>하고 <strong>모듈화</strong>되며, 이후 <strong>Optimizer를 통해 성능 개선</strong>까지 손쉽게 연결할 수 있다.</p>
</section>
<section id="id8">
<h3>4.3 DSPy의 장점과 한계<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<p><strong>장점:</strong></p>
<ul class="simple">
<li><p><strong>모듈화</strong>: 프롬프트를 재사용 가능한 컴포넌트로 구성할 수 있다</p></li>
<li><p><strong>자동 최적화</strong>: Optimizer를 통해 프롬프트를 자동으로 개선할 수 있다</p></li>
<li><p><strong>타입 안전성</strong>: 입력/출력 타입을 명시하여 오류를 줄인다</p></li>
<li><p><strong>재현성</strong>: 코드로 프롬프트를 관리하여 재현 가능하다</p></li>
</ul>
<p><strong>한계:</strong></p>
<ul class="simple">
<li><p><strong>학습 곡선</strong>: 새로운 개념과 패러다임을 익혀야 한다</p></li>
<li><p><strong>제한적 모듈</strong>: 모든 프롬프팅 기법이 모듈로 제공되지 않는다</p></li>
<li><p><strong>성능 의존성</strong>: 최적화 결과가 평가 지표에 크게 의존한다</p></li>
</ul>
</section>
</section>
<section id="ape">
<h2>5. 자동 프롬프트 최적화(APE)와 최신 동향<a class="headerlink" href="#ape" title="Link to this heading">#</a></h2>
<p>프롬프트를 사람 손으로 실험하며 최적화하는 과정은 매우 번거롭기 때문에, <strong>자동 프롬프트 최적화</strong>에 대한 연구가 활발하다. 이를 가리켜 흔히 **Automated Prompt Engineering (APE)**이라 부르며, LLM 자체를 활용해 최적의 지시문이나 예제를 <strong>검색</strong>하거나 <strong>진화</strong>시키는 접근이다.</p>
<section id="automatic-prompt-engineer-ape">
<h3>5.1 Automatic Prompt Engineer (APE)<a class="headerlink" href="#automatic-prompt-engineer-ape" title="Link to this heading">#</a></h3>
<p><strong>Automatic Prompt Engineer (APE)</strong> 기법은 <strong>프롬프트를 프로그램으로 간주한 최적화 문제</strong>로 정의한다. Zhou 등(2022)의 APE 논문에서는, <strong>LLM이 후보 지시문들을 생성</strong>하고, 별도의 검증 모델로 각 후보의 성능을 평가하여 <strong>최고 성능의 프롬프트</strong>를 선택하는 루프를 제안했다. 이 방법을 통해 여러 NLP 과제에서 사람 작성 프롬프트보다 뛰어난 성능을 보였고, 24개 과제 중 19개에서 인간이 디자인한 프롬프트 수준 혹은 그 이상의 결과를 얻었다.</p>
</section>
<section id="opro-optimization-by-prompting">
<h3>5.2 OPRO (Optimization by PROmpting)<a class="headerlink" href="#opro-optimization-by-prompting" title="Link to this heading">#</a></h3>
<p>최신 연구 중 하나인 **OPRO (Optimization by PROmpting)**는 아예 <strong>LLM을 최적화 도구</strong>로 활용하는 방법이다. 사람이 명시적으로 프롬프트를 만들지 않고, “<strong>목표 성능을 높이는 프롬프트</strong>”를 찾는 <strong>자연어 최적화 문제</strong>로 변환하여 LLM이 단계적으로 더 나은 프롬프트를 생성하도록 한다. 예를 들어 OPRO는 먼저 현재까지 생성된 프롬프트들과 성능을 요약하여 LLM에 제시하고, <strong>다음 iteration의 새로운 프롬프트</strong>를 출력받는 식으로 반복한다. 이렇게 하면 점진적으로 점수가 개선되는 방향으로 프롬프트가 진화한다.</p>
</section>
<section id="id9">
<h3>5.3 성능 향상 사례<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>이러한 자동 기법들은 실제로 <strong>최첨단 성능</strong>을 달성하는 데 크게 기여하고 있다. 특히 <strong>수학 문제</strong> 벤치마크인 GSM8K에서, APE 기반 방법들이 GPT-4 수준의 성능까지 도달하는 사례가 나왔다. 한 예로, 오픈소스 <strong>Ape</strong> 도구는 GSM8K **정답률 93%**를 달성하여, 동일 모델의 기본 프롬프트 성능(70%)이나 DSPy 최적화 성능(86%)보다 훨씬 높았다. Google 연구진의 OPRO 기법 역시 <strong>인간 설계 프롬프트 대비 GSM8K 정확도를 8%p 이상 향상</strong>시켜 SOTA에 근접한 결과를 보고하였고, Big-Bench Hard와 같은 난해한 과제에서도 최대 50%p 향상을 이루었다고 한다.</p>
<p>또 다른 흥미로운 방향으로, <strong>PromptWizard</strong>와 같은 프레임워크에서는 LLM의 <strong>피드백 주도(feedback-driven) 반복</strong>으로 프롬프트와 few-shot 예제를 함께 최적화하는 전략을 취하고 있으며, <strong>PanelGPT</strong>처럼 여러 LLM이 토론하듯 프롬프트를 평가/개선하는 아이디어도 제시되고 있다. 이러한 도구와 논문들은 모두 <strong>프롬프트 자동 개선</strong>을 통해 모델의 잠재력을 극대화하려는 흐름에 있다.</p>
</section>
<section id="id10">
<h3>5.4 자동 프롬프트 최적화의 의의<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<p>요약하면, 자동 프롬프트 최적화(APE)는 최신 LLM 시대에 등장한 **”프롬프트를 위한 AutoML”**이라고 할 수 있다. 이를 통해 최소한의 인적 개입으로도 높은 성능의 지시문을 얻을 수 있으며, 실제 오픈소스로도 <strong>PromptChef/Ape</strong>, <strong>DSPy Optimizer</strong>, <strong>PromptWizard</strong> 등이 공개되어 연구자와 개발자를 돕고 있다.</p>
</section>
</section>
<section id="id11">
<h2>6. 실습 예시: DSPy를 활용한 프롬프트 자동 최적화 파이프라인<a class="headerlink" href="#id11" title="Link to this heading">#</a></h2>
<p>마지막으로, 앞서 소개한 DSPy 프레임워크를 이용하여 <strong>프롬프트 자동 최적화</strong> 파이프라인을 구성하는 실습 예시를 살펴보자. 여기서는 간단한 분류 문제를 예로 들어, <strong>문제 정의 → Signature/Module 구성 → Optimizer로 개선 → 성능 확인</strong>의 단계를 거친다.</p>
<section id="id12">
<h3>6.1 문제 정의<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>예를 들어 <em>역사적 사건 설명</em>을 입력으로 받아 <strong>사건의 분야</strong>를 분류하는 과제를 생각해보자. 출력 레이블은 “전쟁/분쟁”, “정치/통치”, “과학/기술” 등 10여 개 카테고리 중 하나다. 모델의 출력에 <strong>confidence score</strong>도 포함시켜 불확실성도 확인하도록 설정한다.</p>
</section>
<section id="signature-module">
<h3>6.2 Signature &amp; Module 구성<a class="headerlink" href="#signature-module" title="Link to this heading">#</a></h3>
<p>우선 DSPy에서 시그니처 클래스를 정의한다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Literal</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dspy</span>

<span class="c1"># 1. 시그니처 정의</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CategorizeEvent</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Signature</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Classify historic events into categories.&quot;&quot;&quot;</span>
    <span class="n">event</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">InputField</span><span class="p">()</span>
    <span class="n">category</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;Wars&quot;</span><span class="p">,</span> <span class="s2">&quot;Politics&quot;</span><span class="p">,</span> <span class="s2">&quot;Science&quot;</span><span class="p">,</span> <span class="s2">&quot;Culture&quot;</span><span class="p">,</span> <span class="s2">&quot;Economics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">OutputField</span><span class="p">()</span>
    <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">OutputField</span><span class="p">()</span>

<span class="c1"># 2. 모듈 생성</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="n">CategorizeEvent</span><span class="p">)</span>

<span class="c1"># 3. 초기 성능 평가 (예시)</span>
<span class="n">test_events</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;제2차 세계대전이 1939년에 시작되었다&quot;</span><span class="p">,</span>
    <span class="s2">&quot;아인슈타인이 상대성이론을 발표했다&quot;</span><span class="p">,</span>
    <span class="s2">&quot;프랑스 혁명이 1789년에 일어났다&quot;</span>
<span class="p">]</span>

<span class="c1"># 4. Optimizer를 통한 자동 개선</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dspy.teleprompt</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIPROv2</span>

<span class="k">def</span><span class="w"> </span><span class="nf">validate_category</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">prediction</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">example</span><span class="o">.</span><span class="n">category</span> <span class="o">==</span> <span class="n">prediction</span><span class="o">.</span><span class="n">category</span> <span class="k">else</span> <span class="mf">0.0</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">MIPROv2</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="n">validate_category</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="s2">&quot;light&quot;</span><span class="p">)</span>
<span class="n">optimized_classifier</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">trainset</span><span class="o">=</span><span class="n">train_examples</span><span class="p">)</span>

<span class="c1"># 5. 성능 개선 확인</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">optimized_classifier</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="s2">&quot;아인슈타인이 상대성이론을 발표했다&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;분류: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">category</span><span class="si">}</span><span class="s2">, 신뢰도: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">confidence</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>위와 같이 Signature에 입력(event)과 출력(category, confidence) 필드를 선언하면, DSPy가 해당 구조를 따라 <strong>기본 프롬프트</strong>를 만들어낸다. dspy.Predict 모듈은 0-shot 프롬프트를 생성하므로, 이 상태에서 모델을 호출하면 아직 최적화되지 않은 <strong>보일러플레이트 프롬프트</strong>로 분류 작업을 수행하게 된다.</p>
</section>
<section id="id13">
<h3>6.3 DSPy 최적화 과정<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>초기 성능 평가</strong>: 준비된 classifier 모듈을 가지고 소량의 예시 입력에 대한 성능(분류 정확도)을 측정한다. 예컨대 위 과제에 대해 20개의 역사 사건 설명을 정답 레이블과 함께 평가했더니 <strong>정확도 52%</strong> 정도가 나왔다고 가정한다.</p></li>
<li><p><strong>Optimizer 적용</strong>: DSPy의 <strong>MIPROv2</strong>를 사용하여 프롬프트를 최적화한다. MIPROv2는 모델 가중치는 건드리지 않고 <strong>프롬프트 자체</strong>를 개선하는 데 초점을 맞춘 알고리즘이다. compile을 호출하면 MIPROv2가 내부적으로 다음을 수행한다:</p>
<ul class="simple">
<li><p>classifier 모듈을 다양한 입력에 실행해보고, 모델 응답을 수집하여 현재 프롬프트의 성능을 측정</p></li>
<li><p>LLM을 사용해 프롬프트 지시에 대한 여러 <strong>변형 후보</strong>를 생성하거나, 필요한 경우 few-shot 예시 추가 등을 시도</p></li>
<li><p>다양한 후보 프롬프트로 미니 배치 평가를 반복하며 점수가 올라가는 방향으로 <strong>탐색</strong></p></li>
</ul>
</li>
<li><p><strong>성능 개선 확인</strong>: 최적화된 모듈을 동일한 평가 세트에 적용하여 성능을 다시 측정한다. 가령, <strong>정확도가 63%로 향상</strong>되었다면 초기 대비 상당한 개선이다. 실제 사례에서도, DSPy의 optimizer가 <strong>약 51.9%에서 63.0%로</strong> 정확도를 끌어올린 보고가 있다.</p></li>
</ol>
<p>이러한 과정을 통해, DSPy를 사용한 <strong>선언형 프롬프트 설계</strong>와 <strong>자동 최적화</strong> 파이프라인을 구축할 수 있다. 이런 접근은 사람이 직접 프롬프트를 개선하는 데 비해 훨씬 <strong>효율적</strong>이며, 모델의 잠재력을 <strong>체계적으로 끌어올릴</strong> 수 있는 강력한 도구다.</p>
</section>
</section>
<hr class="docutils" />
<section id="id14">
<h2>체크포인트 질문<a class="headerlink" href="#id14" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>역할 프롬프트(Role Prompting)</strong> 기법은 무엇이며, 모델의 응답에 어떠한 영향을 주는가? 또 적용 시 유의해야 할 점은 무엇인가?</p></li>
<li><p><strong>Self-Consistency 디코딩</strong>은 어떻게 동작하며, 왜 Chain-of-Thought 프롬프팅의 성능을 향상시킬 수 있을까? GSM8K에서의 성능 개선 수치를 설명해보라.</p></li>
<li><p><strong>Tree of Thoughts(ToT)</strong> 기법은 어떤 방식으로 문제 해결을 수행하는가? ToT가 <em>Game of 24</em> 퍼즐에서 보여준 성능 향상은 어느 정도였는지 언급하라.</p></li>
<li><p><strong>DSPy의 Signature, Module, Optimizer</strong>는 각각 무엇을 의미하며, 어떤 역할을 하는가? 이를 활용하면 프롬프트 엔지니어링에 어떤 이점이 있는가?</p></li>
<li><p>**자동 프롬프트 최적화(APE)**란 무엇인가? 사람이 작성한 프롬프트와 비교했을 때 APE 기법이 달성한 notable한 성과를 GSM8K 예시를 들어 설명하라.</p></li>
<li><p>주어진 문제에 대해 <strong>DSPy와 Optimizer</strong>를 사용하여 프롬프트를 개선하는 절차를 간략히 요약해보라 (Signature 정의 → 모듈 실행 → Optimizer 적용 → 결과 확인). 또한 이러한 자동 최적화의 장점을 설명해보라.</p></li>
</ol>
</section>
<hr class="docutils" />
<section id="id15">
<h2>참고자료<a class="headerlink" href="#id15" title="Link to this heading">#</a></h2>
<section id="id16">
<h3>주요 논문 및 연구 자료<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Wang, X., et al. (2022). “Self-Consistency Improves Chain of Thought Reasoning in Language Models.” arXiv preprint arXiv:2203.11171.</p></li>
<li><p>Yao, S., et al. (2023). “Tree of Thoughts: Deliberate Problem Solving with Large Language Models.” arXiv preprint arXiv:2305.10601.</p></li>
<li><p>Zhou, D., et al. (2022). “Large Language Models Are Human-Level Prompt Engineers.” arXiv preprint arXiv:2211.01910.</p></li>
<li><p>Yang, C., et al. (2023). “Large Language Models as Optimizers.” arXiv preprint arXiv:2309.03409.</p></li>
</ul>
</section>
<section id="id17">
<h3>기술 문서 및 구현체<a class="headerlink" href="#id17" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>DSPy Official Documentation: <a class="reference external" href="https://dspy.ai/">https://dspy.ai/</a></p></li>
<li><p>Learn Prompting: <a class="reference external" href="https://learnprompting.org/">https://learnprompting.org/</a></p></li>
<li><p>Prompt Engineering Guide: <a class="reference external" href="https://www.promptingguide.ai/">https://www.promptingguide.ai/</a></p></li>
<li><p>PromptWizard Framework: <a class="reference external" href="https://microsoft.github.io/PromptWizard/">https://microsoft.github.io/PromptWizard/</a></p></li>
</ul>
</section>
<section id="id18">
<h3>온라인 리소스 및 블로그<a class="headerlink" href="#id18" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>“Role Prompting: Guide LLMs with Persona-Based Tasks” - Learn Prompting</p></li>
<li><p>“Prompt Architectures: An Overview of structured prompting strategies” - Medium</p></li>
<li><p>“Tree of Thoughts (ToT)” - Prompt Engineering Guide</p></li>
<li><p>“Pipelines &amp; Prompt Optimization with DSPy” - Technical Blog</p></li>
<li><p>“Best Free Prompt Engineering Tools of 2025” - SourceForge</p></li>
</ul>
</section>
<section id="id19">
<h3>벤치마크 및 평가 자료<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>GSM8K: Grade School Math 8K Dataset</p></li>
<li><p>Game of 24: Mathematical Puzzle Benchmark</p></li>
<li><p>Big-Bench Hard: Challenging Language Understanding Tasks</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "entelecheia/deepnlp-2025",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./week04"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
    <div class="giscus"></div>
<script src="https://giscus.app/client.js"        data-repo="entelecheia/deepnlp-2025"        data-repo-id="R_kgDOPjTLcA"        data-category="General"        data-category-id="DIC_kwDOPjTLcM4Cuy8e"        data-mapping="pathname"        data-strict="1"        data-reactions-enabled="1"        data-emit-metadata="1"        data-input-position="bottom"        data-theme="noborder_light"        data-lang="ko"        data-loading="lazy"        crossorigin="anonymous"        async></script>
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../week03/index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Week 3: 현대적 PEFT 기법을 활용한 효율적 파인튜닝</p>
      </div>
    </a>
    <a class="right-next"
       href="../week05/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 5: LLM 평가 패러다임과 벤치마크</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1. 체계적 프롬프트 기법: 역할 부여와 구조화된 프롬프팅</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#role-prompting">1.1 역할 부여(Role Prompting)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#structured-prompting">1.2 구조화된 프롬프팅(Structured Prompting)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">1.3 실습 예제: 체계적 프롬프트 구성</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#self-consistency-gsm8k">2. Self-Consistency 기법과 GSM8K 성능 향상</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gsm8k">2.1 GSM8K 성능 향상 사례</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#self-consistency">2.2 Self-Consistency 구현 예제</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.3 Self-Consistency의 장점과 한계</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tree-of-thoughts">3. Tree of Thoughts 기법: 복잡한 문제 해결을 위한 탐색</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#game-of-24">3.1 Game of 24 성능 향상 사례</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">3.2 Tree of Thoughts 구현 예제</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">3.3 Tree of Thoughts의 장점과 한계</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dspy">4. DSPy 프레임워크: 선언형 프롬프트 프로그래밍</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">4.1 DSPy의 핵심 구성 요소</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#signature">Signature(시그니처)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#module">Module(모듈)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizer">Optimizer(최적화기)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">4.2 DSPy 실습 예제</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">4.3 DSPy의 장점과 한계</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ape">5. 자동 프롬프트 최적화(APE)와 최신 동향</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automatic-prompt-engineer-ape">5.1 Automatic Prompt Engineer (APE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opro-optimization-by-prompting">5.2 OPRO (Optimization by PROmpting)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">5.3 성능 향상 사례</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">5.4 자동 프롬프트 최적화의 의의</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">6. 실습 예시: DSPy를 활용한 프롬프트 자동 최적화 파이프라인</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">6.1 문제 정의</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#signature-module">6.2 Signature &amp; Module 구성</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">6.3 DSPy 최적화 과정</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">체크포인트 질문</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">참고자료</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">주요 논문 및 연구 자료</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">기술 문서 및 구현체</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">온라인 리소스 및 블로그</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">벤치마크 및 평가 자료</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Young Joon Lee
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>
